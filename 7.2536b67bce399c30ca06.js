(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{zQdL:function(e,t,i){"use strict";i.r(t),i.d(t,"LessonsModule",(function(){return q}));var n=i("ofXK"),s=i("tyNb"),a=i("QdkN"),o=i("SxV6"),c=i("lJxs"),l=i("0IaG"),r=i("fXoL"),b=i("c0Wi"),u=i("CZ+i"),d=i("9nlD"),g=i("kmnG"),h=i("qFsG"),p=i("3Pt+");function f(e,t){1&e&&r.Mb(0,"i",7)}function m(e,t){1&e&&r.Mb(0,"i",8)}function v(e,t){if(1&e){const e=r.Rb();r.Qb(0,"i",14),r.Xb("click",(function(){r.pc(e);const t=r.bc().$implicit;return r.bc(2).editCategory(t)})),r.Pb()}}function P(e,t){if(1&e){const e=r.Rb();r.Qb(0,"i",15),r.Xb("click",(function(){r.pc(e);const t=r.bc().$implicit;return r.bc(2).removeCategory(null==t?null:t.id)})),r.Pb()}}function Q(e,t){if(1&e&&(r.Qb(0,"tr"),r.Qb(1,"td"),r.Ac(2),r.Pb(),r.Qb(3,"td"),r.Ac(4),r.Pb(),r.Qb(5,"td",10),r.yc(6,v,1,0,"i",12),r.yc(7,P,1,0,"i",13),r.Pb(),r.Pb()),2&e){const e=t.$implicit,i=t.index,n=r.bc(2);r.zb(2),r.Bc(i+1),r.zb(2),r.Bc(null==e?null:e.name),r.zb(2),r.hc("ngIf",!n.isEditMode),r.zb(1),r.hc("ngIf",!n.isEditMode)}}function w(e,t){if(1&e&&(r.Qb(0,"div",9),r.Qb(1,"table"),r.Qb(2,"thead"),r.Qb(3,"tr"),r.Qb(4,"th"),r.Ac(5,"No"),r.Pb(),r.Qb(6,"th"),r.Ac(7,"Category"),r.Pb(),r.Qb(8,"th",10),r.Ac(9,"Actions"),r.Pb(),r.Pb(),r.Pb(),r.Qb(10,"tbody"),r.yc(11,Q,8,4,"tr",11),r.Pb(),r.Pb(),r.Pb()),2&e){const e=r.bc();r.zb(11),r.hc("ngForOf",e.lessonCategories)}}let y=(()=>{class e{constructor(e,t,i,n,s,a){this.dialogRef=e,this.dialogData=t,this.lessonsService=i,this.dialog=n,this.dataValueService=s,this.notificationService=a}ngOnInit(){this.getCategories()}removeCategory(e){this.dialog.open(a.a,{width:"30rem"}).afterClosed().pipe(Object(o.a)()).subscribe(t=>{t&&this.dataValueService.deleteDataValue(e).pipe(Object(o.a)()).subscribe(()=>{this.getCategories(),this.notificationService.success()})})}editCategory(e){this.editedCategory=e,this.isEditMode=!0,this.inputField=e.name}saveCategory(){if(!this.inputField)return;const e={data_key_id:"a75c99fc-919a-11ec-859e-3cecef02c254",value:"lesson_category_"+this.inputField,en:{name:this.inputField},ru:{name:this.inputField}};this.isEditMode?this.dataValueService.editDataValue(this.editedCategory.id,e).pipe(Object(o.a)()).subscribe(()=>{this.isEditMode=!1,this.inputField="",this.notificationService.success(),this.getCategories()},()=>this.notificationService.error()):this.dataValueService.addDataValue(e).pipe(Object(o.a)()).subscribe(()=>{this.inputField="",this.notificationService.success(),this.getCategories()},()=>this.notificationService.error())}getCategories(){this.dataValueService.getDataValues({include:["dataValues"]}).pipe(Object(o.a)(),Object(c.a)(e=>e.data[2].dataValues.data)).subscribe(e=>{this.lessonCategories=e},()=>this.notificationService.error())}closePopup(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(l.d),r.Lb(l.a),r.Lb(b.a),r.Lb(l.b),r.Lb(u.a),r.Lb(d.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-lessons-category"]],decls:9,vars:4,consts:[[1,"d-flex"],["appearance","fill",1,"example-full-width"],["matInput","","type","text","name","category",3,"ngModel","ngModelChange"],[1,"primary",3,"click"],["class","bx bx-plus",4,"ngIf"],["class","bx bxs-pencil",4,"ngIf"],["class","overflow-auto",4,"ngIf"],[1,"bx","bx-plus"],[1,"bx","bxs-pencil"],[1,"overflow-auto"],[1,"text-right"],[4,"ngFor","ngForOf"],["class","bx bxs-pencil",3,"click",4,"ngIf"],["class","bx bxs-trash",3,"click",4,"ngIf"],[1,"bx","bxs-pencil",3,"click"],[1,"bx","bxs-trash",3,"click"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"mat-form-field",1),r.Qb(2,"mat-label"),r.Ac(3,"Category Name"),r.Pb(),r.Qb(4,"input",2),r.Xb("ngModelChange",(function(e){return t.inputField=e})),r.Pb(),r.Pb(),r.Qb(5,"button",3),r.Xb("click",(function(){return t.saveCategory()})),r.yc(6,f,1,0,"i",4),r.yc(7,m,1,0,"i",5),r.Pb(),r.Pb(),r.yc(8,w,12,1,"div",6)),2&e&&(r.zb(4),r.hc("ngModel",t.inputField),r.zb(2),r.hc("ngIf",!t.isEditMode),r.zb(1),r.hc("ngIf",t.isEditMode),r.zb(1),r.hc("ngIf",null==t.lessonCategories?null:t.lessonCategories.length))},directives:[g.c,g.f,h.a,p.b,p.o,p.r,n.l,n.k],styles:["table[_ngcontent-%COMP%]{min-width:unset}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:40px}"]}),e})();var C=i("quSY"),S=i("LvDl"),x=i("d3UM"),L=i("FKr1"),O=i("QwIL");function A(e,t){if(1&e&&(r.Qb(0,"mat-option",17),r.Ac(1),r.Pb()),2&e){const e=t.$implicit;r.hc("value",e.id),r.zb(1),r.Cc(" ",e.name," ")}}function I(e,t){if(1&e){const e=r.Rb();r.Qb(0,"div",2),r.Qb(1,"div",8),r.Qb(2,"app-image-uploader",18),r.Xb("changeImageSource",(function(t){r.pc(e);const i=r.bc();return i.imgSource=t,i.showRemoveButton=!0}))("removeImage",(function(){return r.pc(e),r.bc().removeImage()})),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=r.bc();r.zb(2),r.hc("id",e.lesson.id)("endpoint","lesson-question")("imgSource",e.imgSource)("isNew",e.isNew)("showRemoveButton",e.showRemoveButton)}}let z=(()=>{class e{constructor(e,t,i,n,s){this.dialogRef=e,this.dialogData=t,this.formBuilder=i,this.lessonService=n,this.notificationService=s,this.imgSource="assets/images/empty_image.png"}ngOnInit(){var e,t,i,n;this.lesson=null===(e=this.dialogData)||void 0===e?void 0:e.lesson,this.isNew=!this.lesson,this.categories=null===(t=this.dialogData)||void 0===t?void 0:t.categories,Object(S.isEmpty)(null===(n=null===(i=this.lesson)||void 0===i?void 0:i.image)||void 0===n?void 0:n.data)||(this.showRemoveButton=!0,this.imgSource=this.lesson.image.data.url),this.initForm()}closePopup(){this.dialogRef.close()}removeImage(){var e,t;Object(S.isEmpty)(null===(t=null===(e=this.lesson)||void 0===e?void 0:e.image)||void 0===t?void 0:t.data)||this.lessonService.removeImage(this.lesson.id,this.lesson.image.data.id).pipe(Object(o.a)()).subscribe(()=>{this.imgSource="assets/images/empty_image.png",this.showRemoveButton=!1})}fetchForm(){this.form.invalid?this.form.markAsDirty():this.isNew?this.lessonService.createLesson(this.form.value,{include:["category","translations"]}).pipe(Object(o.a)()).subscribe(e=>{this.notificationService.success(),this.dialogRef.close(e.data)}):this.lessonService.updateLesson(this.lesson.id,this.form.value,{include:["category","translations"]}).pipe(Object(o.a)()).subscribe(()=>{this.notificationService.success(),this.dialogRef.close()})}initForm(){let e,t;this.isNew||(e=this.lesson.translations.data.find(e=>"en"===e.locale),t=this.lesson.translations.data.find(e=>"ru"===e.locale)),this.form=this.formBuilder.group({lesson_question_category_data_value_id:[this.isNew?null:this.lesson.category.data.id,p.v.required],en:this.formBuilder.group({content:[this.isNew?"empty":e.content,p.v.required],answer:[this.isNew?"empty":e.answer,p.v.required]}),ru:this.formBuilder.group({content:[this.isNew?null:t.content,p.v.required],answer:[this.isNew?null:t.answer,p.v.required]})})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(l.d),r.Lb(l.a),r.Lb(p.d),r.Lb(b.a),r.Lb(d.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-lessons-form"]],decls:41,vars:5,consts:[[1,"text-center"],["enctype","multipart/form-data",3,"formGroup"],[1,"row"],[1,"col-md-12"],["appearance","fill"],["formControlName","lesson_question_category_data_value_id"],[3,"value",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"col-md-6"],["formGroupName","en"],["appearance","fill",1,"example-full-width"],["rows","5","matInput","","formControlName","content"],["rows","5","matInput","","formControlName","answer"],["formGroupName","ru"],[1,"popup-actions","mt-3"],["type","button",1,"secondary",3,"click"],["type","submit",1,"primary",3,"click"],[3,"value"],[3,"id","endpoint","imgSource","isNew","showRemoveButton","changeImageSource","removeImage"]],template:function(e,t){1&e&&(r.Qb(0,"h3",0),r.Ac(1),r.Pb(),r.Qb(2,"form",1),r.Qb(3,"div",2),r.Qb(4,"div",3),r.Qb(5,"mat-form-field",4),r.Qb(6,"mat-label"),r.Ac(7,"Select category"),r.Pb(),r.Qb(8,"mat-select",5),r.yc(9,A,2,2,"mat-option",6),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.yc(10,I,3,5,"div",7),r.Qb(11,"div",2),r.Qb(12,"div",8),r.Qb(13,"h3",0),r.Ac(14,"English"),r.Pb(),r.Ob(15,9),r.Qb(16,"mat-form-field",10),r.Qb(17,"mat-label"),r.Ac(18,"Question"),r.Pb(),r.Mb(19,"textarea",11),r.Pb(),r.Qb(20,"mat-form-field",10),r.Qb(21,"mat-label"),r.Ac(22,"Answer"),r.Pb(),r.Mb(23,"textarea",12),r.Pb(),r.Nb(),r.Pb(),r.Qb(24,"div",8),r.Qb(25,"h3",0),r.Ac(26,"Russian"),r.Pb(),r.Ob(27,13),r.Qb(28,"mat-form-field",10),r.Qb(29,"mat-label"),r.Ac(30,"Question"),r.Pb(),r.Mb(31,"textarea",11),r.Pb(),r.Qb(32,"mat-form-field",10),r.Qb(33,"mat-label"),r.Ac(34,"Answer"),r.Pb(),r.Mb(35,"textarea",12),r.Pb(),r.Nb(),r.Pb(),r.Pb(),r.Qb(36,"div",14),r.Qb(37,"button",15),r.Xb("click",(function(){return t.closePopup()})),r.Ac(38," Cancel "),r.Pb(),r.Qb(39,"button",16),r.Xb("click",(function(){return t.fetchForm()})),r.Ac(40),r.Pb(),r.Pb(),r.Pb()),2&e&&(r.zb(1),r.Bc(t.isNew?"Add lesson":"Edit lesson "+(null==t.lesson?null:t.lesson.code)),r.zb(1),r.hc("formGroup",t.form),r.zb(7),r.hc("ngForOf",t.categories),r.zb(1),r.hc("ngIf",!t.isNew),r.zb(30),r.Cc(" ",t.isNew?"Create":"Update"," "))},directives:[p.x,p.p,p.h,g.c,g.f,x.a,p.o,p.g,n.k,n.l,p.i,h.a,p.b,L.f,O.a],encapsulation:2}),e})();var M=i("M9IT");function k(e,t){1&e&&(r.Qb(0,"p",5),r.Ac(1,"No data"),r.Pb())}function N(e,t){if(1&e){const e=r.Rb();r.Qb(0,"tr"),r.Qb(1,"td"),r.Ac(2),r.Pb(),r.Qb(3,"td"),r.Ac(4),r.Pb(),r.Qb(5,"td"),r.Ac(6),r.Pb(),r.Qb(7,"td"),r.Ac(8),r.Pb(),r.Qb(9,"td"),r.Ac(10),r.Pb(),r.Qb(11,"td"),r.Ac(12),r.Pb(),r.Qb(13,"td",7),r.Qb(14,"i",8),r.Xb("click",(function(){r.pc(e);const i=t.$implicit;return r.bc(2).openLessonDialog(i)})),r.Pb(),r.Qb(15,"i",9),r.Xb("click",(function(){r.pc(e);const i=t.$implicit;return r.bc(2).removeLesson.emit(null==i?null:i.id)})),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=t.$implicit;r.zb(2),r.Bc(null==e?null:e.code),r.zb(2),r.Bc(null==e||null==e.category?null:e.category.data.name),r.zb(2),r.Bc(null==e||null==e.translations||null==e.translations.data[0]?null:e.translations.data[0].content),r.zb(2),r.Bc(null==e||null==e.translations||null==e.translations.data[0]?null:e.translations.data[0].answer),r.zb(2),r.Bc(null==e||null==e.translations||null==e.translations.data[1]?null:e.translations.data[1].content),r.zb(2),r.Bc(null==e||null==e.translations||null==e.translations.data[1]?null:e.translations.data[1].answer)}}function F(e,t){if(1&e&&(r.Qb(0,"table"),r.Qb(1,"thead"),r.Qb(2,"tr"),r.Qb(3,"th"),r.Ac(4,"No"),r.Pb(),r.Qb(5,"th"),r.Ac(6,"Category"),r.Pb(),r.Qb(7,"th"),r.Ac(8,"Question EN"),r.Pb(),r.Qb(9,"th"),r.Ac(10,"Answer EN"),r.Pb(),r.Qb(11,"th"),r.Ac(12,"Question RU"),r.Pb(),r.Qb(13,"th"),r.Ac(14,"Answer RU"),r.Pb(),r.Qb(15,"th"),r.Ac(16,"Actions"),r.Pb(),r.Pb(),r.Pb(),r.Qb(17,"tbody"),r.yc(18,N,16,6,"tr",6),r.Pb(),r.Pb()),2&e){const e=r.bc();r.zb(18),r.hc("ngForOf",e.lessons)}}const _=function(){return[5,10,25,100]};function j(e,t){if(1&e){const e=r.Rb();r.Qb(0,"mat-paginator",10),r.Xb("page",(function(t){return r.pc(e),r.bc().changePage(t)})),r.Pb()}if(2&e){const e=r.bc();r.hc("length",null==e.pagination?null:e.pagination.length)("pageSize",null==e.pagination?null:e.pagination.pageSize)("pageSizeOptions",r.ic(3,_))}}let R=(()=>{class e{constructor(e){this.dialog=e,this.changePagination=new r.n,this.removeLesson=new r.n,this.changedPagination={page:1,perPage:15}}openLessonDialog(e=null){this.dialog.open(z,{width:"60rem",data:{lesson:e,categories:this.categories}}).afterClosed().pipe(Object(o.a)()).subscribe(e=>{this.changePagination.emit(this.changedPagination),e&&this.openLessonDialog(e)})}changePage(e){this.changedPagination.page=e.pageIndex+1,this.changedPagination.perPage=e.pageSize,this.changePagination.emit(this.changedPagination)}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(l.b))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-lessons-list"]],inputs:{lessons:"lessons",categories:"categories",pagination:"pagination"},outputs:{changePagination:"changePagination",removeLesson:"removeLesson"},decls:6,vars:3,consts:[[1,"secondary","d-block","ml-auto",3,"click"],[1,"overflow-auto"],["class","text-center",4,"ngIf"],[4,"ngIf"],["aria-label","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443",3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"text-right"],[1,"bx","bxs-pencil",3,"click"],[1,"bx","bxs-trash",3,"click"],["aria-label","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443",3,"length","pageSize","pageSizeOptions","page"]],template:function(e,t){1&e&&(r.Qb(0,"button",0),r.Xb("click",(function(){return t.openLessonDialog()})),r.Ac(1,"Add lesson"),r.Pb(),r.Qb(2,"div",1),r.yc(3,k,2,0,"p",2),r.yc(4,F,19,1,"table",3),r.yc(5,j,1,4,"mat-paginator",4),r.Pb()),2&e&&(r.zb(3),r.hc("ngIf",!(null!=t.lessons&&t.lessons.length)),r.zb(1),r.hc("ngIf",null==t.lessons?null:t.lessons.length),r.zb(1),r.hc("ngIf",null==t.lessons?null:t.lessons.length))},directives:[n.l,n.k,M.a],styles:["table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:60px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:200px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(7){width:100px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:0}"]}),e})();var B=i("aF9I");const D=[{path:"",component:(()=>{class e{constructor(e,t,i,n){this.dialog=e,this.dataValueService=t,this.lessonsService=i,this.notificationService=n,this.options={include:["category","translations","image"],page:1,perPage:15},this.subscription=new C.a}ngOnInit(){this.getLessons(),this.getCategories()}ngOnDestroy(){this.subscription.unsubscribe()}openCategoryList(){this.dialog.open(y,{width:"60rem",data:{categories:this.categories}})}getCategories(){this.subscription.add(this.dataValueService.getDataValues({include:["dataValues"]}).pipe(Object(c.a)(e=>e.data[2].dataValues.data)).subscribe(e=>{this.categories=e}))}openLessonDialog(e=null){this.dialog.open(z,{width:"60rem",data:{lesson:e,categories:this.categories}})}removeLesson(e){this.dialog.open(a.a,{width:"30rem"}).afterClosed().pipe(Object(o.a)()).subscribe(t=>{t&&this.lessonsService.removeLesson(e).pipe(Object(o.a)()).subscribe(()=>{this.getLessons(),this.notificationService.success()})})}getLessons(e=null){e&&(this.options=Object.assign(Object.assign({},this.options),e)),this.subscription.add(this.lessonsService.getLessons(this.options).pipe(Object(c.a)(e=>(this.pagination={length:e.meta.pagination.total,pageSize:e.meta.pagination.per_page},e.data))).subscribe(e=>this.lessons=e))}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(l.b),r.Lb(u.a),r.Lb(b.a),r.Lb(d.a))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-lessons"]],decls:9,vars:3,consts:[[1,"minus-header-footer-height"],[1,"container","py-50"],[1,"d-flex","justify-content-between","mb-4"],[1,"sub-title"],[1,"secondary",3,"click"],[3,"lessons","pagination","categories","removeLesson","changePagination"]],template:function(e,t){1&e&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Qb(2,"div",2),r.Qb(3,"h2",3),r.Ac(4,"Lessons list"),r.Pb(),r.Qb(5,"button",4),r.Xb("click",(function(){return t.openCategoryList()})),r.Ac(6,"Open Categories"),r.Pb(),r.Pb(),r.Qb(7,"app-lessons-list",5),r.Xb("removeLesson",(function(e){return t.removeLesson(e)}))("changePagination",(function(e){return t.getLessons(e)})),r.Pb(),r.Pb(),r.Pb(),r.Mb(8,"app-footer")),2&e&&(r.zb(7),r.hc("lessons",t.lessons)("pagination",t.pagination)("categories",t.categories))},directives:[R,B.a],encapsulation:2}),e})()}];let V=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[s.g.forChild(D)],s.g]}),e})();var X=i("PCNd"),E=i("evvh");let q=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(t){return new(t||e)},imports:[[n.c,V,X.a,E.a]]}),e})()}}]);